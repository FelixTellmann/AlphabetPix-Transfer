<div class="cart page-width{% if cart.items.size == 0%} cart--empty{% endif %}" data-section-id="{{ section.id }}" data-section-type="cart-template" data-cart-token="{{ cart.id }}">


  <div class="section-header section-header--small text-center">
    <h1 class="section-header__title h2">{{ 'cart.general.title' | t }}</h1>
  </div>

  {% comment %}
  Cart no cookies state
  {% endcomment %}
  <div class="cart__no-cookies">
    <div class="cart-message text-center">
      <p>{{ 'cart.general.cookies_required' | t }}</p>
    </div>
  </div>

  {% comment %}
  Cart Empty State
  {% endcomment %}
  <div class="cart__empty">
    <div class="cart-message text-center">
      <p>{{ 'cart.general.empty' | t }}</p>
      <p>{{ 'cart.general.continue_browsing_html' | t: classes: 'btn btn--primary' }}</p>
    </div>
  </div>

  <form action="/cart" method="post" novalidate class="cart__form">
    <table class="cart__table">
      <thead class="cart__table-header border-bottom">
        <tr>
          <th class="text-left">{{ 'cart.label.product' | t }}</th>
          <th class="text-center">{{ 'cart.label.price' | t }}</th>
          <th class="text-center">{{ 'cart.label.quantity' | t }}</th>
          <th class="text-right">{{ 'cart.label.total' | t }}</th>
        </tr>
      </thead>
    
      <tbody data-cart-item-list>
        {%- assign cartItems = 'template ' | split: ' ' -%}
        {% if cart.items.size > 0 %}
          {%- assign cartItems = cart.items -%}
        {% endif %}

        {% for item in cartItems %}
          <tr class="cart-item{% if item == 'template' %} ajax-cart__template{% endif %}" data-cart-item data-cart-item-id="{{ item.key }}">
            <td style="max-width: 810px;"> <!-- ================ CAN CHANGE CLASS ADD FRAME HERE ================ -->
              
              
              {% assign product = item.product %}
              
              {% for image in product.images %}
                {% if image.src contains 'left' %}
                  {% assign frame_left = image.src  %}
                {% elsif image.src contains 'center' %}
                  {% assign frame_center = image.src  %}
                {% elsif image.src contains 'right' %}
                  {% assign frame_right = image.src  %}
                {% endif %}
              {% endfor %}
              
              {% assign number_of_letters = 0 %}
              {% for p in item.properties %}
                {% if p.first contains 'Letter' %}
                  {% assign number_of_letters = number_of_letters | plus: 1 %}
                {% endif %}
              {% endfor %}
  
              
              
              <script>
                /*$(function () {
                  setTimeout(function () {
                    domtoimage.toJpeg($('.cart-item__frame[data-item-id="{{ item.id }}"]')[0], {quality: 0.95})
                      .then(function (dataUrl) {
                        let img = new Image();
                        img.src = dataUrl;
                        $('.cart-item__frame[data-item-id="{{ item.id }}"]').empty().append(img)
                      })
                      .catch(function (error) {
                        console.error('oops, something went wrong!', error);
                      });
                  }, 2800); /!* Timer might need to be adjusted for image load to be completed *!/
                })*/
              </script>
  
              <style>
                .cart-item__frame--center[data-item-id="{{ item.id }}"] {
                  width: calc(3.2vw + (7.6vw * {{ number_of_letters }}));
                  max-width: calc(38.4px + (91.2px * {{ number_of_letters }}));
                }
              </style>
  
              <figure class="cart-item__frame" data-item-id="{{ item.id }}">
                <img src="{{ frame_left | product_img_url: '2000x' }}" alt="" class="cart-item__frame--left" data-item-id="{{ item.id }}">
                <img src="{{ frame_center | product_img_url: '2000x' }}" alt="" class="cart-item__frame--center" data-item-id="{{ item.id }}">
                <img src="{{ frame_right | product_img_url: '2000x' }}" alt="" class="cart-item__frame--right" data-item-id="{{ item.id }}">
                <figure class="cart-item__letters">
                  {% for p in item.properties %}
                    {% if p.first contains 'Letter' %}
                      {% assign value = p.last | split: '-' %}
                      {% if value[0] contains '_' %}
                        {% capture productHandle %}letter-symbol-{{ value[0] | replace: '_' }}{% endcapture %}
                      {% else %}
                        {% capture productHandle %}letter-{{ value[0] }}{% endcapture %}
                      {% endif %}
                      {% assign product = all_products[productHandle] %}
                      {% for variant in product.variants %}{% if variant.sku == p.last %}<img class="cart-item__letter-img" data-letter-class=" {{ productVariant[0] }}" data-variant-id="{{ variantId }}" src="{{ variant.image.src | product_img_url: '300x' }}" alt="">{% endif %}{% endfor %}
                    {% endif %}
                  {% endfor %}
                </figure>
              </figure>
              
            </td>
          <!-- ================ USE THE BELOW INFO TO ADD IMPORTANT INFO TO THE FRAME FOR CHANGES i.e. Remove item etc. ================ -->
            {% comment %}{#<td class="cart-item__meta small--text-left">
              {% assign itemImage = true %}
              {% if item.image == blank and item.product.featured_image == blank %}
                {% assign itemImage = false %}
              {% endif %}
              <a class="cart-item__image-link" href="{{ item.url | within: collections.all }}" style="background-image: {% if itemImage %}url('{{ item | img_url: 'medium' }}'){% else %}none{% endif %};" data-cart-item-background-image data-cart-item-href>
                <img class="cart-item__image lazyload {% unless itemImage %}hide{% endunless %}" src="{{ item | img_url: 'medium' }}" alt="{{ item.title | escape }}" data-cart-item-image>
              </a>
              
              <a class="cart-item__meta-title h4" href="{{ item.url }}" data-cart-item-href data-cart-item-title>{{ item.product.title }}</a>

              <p class="cart-item__meta-variant" data-cart-item-variant-title>
                {% unless item.product.variants.size == 1 and item.product.options.size == 1 and item.product.options.first == 'Title' and item.variant.title == 'Default Title' %}
                  {{ item.variant.title }}
                {% endunless %}
              </p>
              
              {%- assign itemProperties = 'template ' | split: ' ' -%}
              {%- assign property_size = item.properties | size -%}

              {% if property_size > 0 %}
                {%- assign itemProperties = item.properties -%}
              {% endif %}

              <ul class="cart-item__properties" data-cart-item-property-list>
                {% for p in itemProperties %}
                  <li class="cart-item__property{% if p == 'template' %} ajax-cart__template{% endif %}{% if p.last == blank %} visually-hidden{% endif %}" data-cart-item-property>
                    {{ p.first }}:

                    {% comment %}
                    Check if there was an uploaded file associated
                    {% endcomment %}
                    {% if p.last contains '/uploads/' %}
                      <a href="{{ p.last }}">{{ p.last | split: '/' | last }}</a>
                    {% else %}
                      {{ p.last }}
                    {% endif %}
                  </li>
                {% endfor %}
              </ul>

              <p class="cart-item__price-container medium-up--hide">
                <span class="cart-item__price" data-cart-item-price>{{ item.price | money }}</span>
                <s class="cart-item__original-price" data-cart-item-original-price>{% if item.price != item.original_price %}{{ item.original_price | money }}{% endif %}</s>
              </p>

              <div class="cart-item__discount-container" data-cart-item-discount-list>
                {% comment %}
                If the item has no properties, then include a property element with a template class
                so that it is hidden but still available for use client-side by ajax-cart.js
                {% endcomment %}

                {%- assign itemDiscounts = 'template ' | split: ' ' -%}
                {% if item.discounts.size > 0 %}
                  {%- assign itemDiscounts = item.discounts -%}
                {% endif %}

                {% for discount in itemDiscounts %}
                  <p class="cart-item__discount text-small{% if discount == 'template' %} ajax-cart__template{% endif %}" data-cart-item-discount>{{ discount.title }}</p>
                {% endfor %}
              </div>

              <p class="small--hide">
                <a href="/cart/change?line={{ forloop.index }}&amp;quantity=0" class="btn btn--small btn--clear btn--primary-color cart-item__remove" data-cart-item-delete>{{ 'cart.general.remove' | t }}</a>
              </p>

              <p class="cart-item__message" data-item-message></p>
            </td>#}{% endcomment %}

            <td class="cart-item__price-wrapper small--hide">
              <p>
                <span class="cart-item__price" data-cart-item-price>{{ item.price | money }}</span>
                <s class="cart-item__original-price" data-cart-item-original-price>{% if item.price != item.original_price %}{{ item.original_price | money }}{% endif %}</s>
              </p>
            </td>

            <td class="cart-item__update-wrapper text-right">

              <div class="cart-item__qty">
                <label for="quantity_{{ item.key }}" class="cart-item__qty-label" data-cart-item-label-quantity>{{ 'cart.label.quantity' | t }}</label>
                <input id="quantity_{{ item.key }}" class="cart-item__qty-input" value="{{ item.quantity }}" type="number" pattern="\d*" min="1" name="updates[{{ item.key }}]" data-cart-item-input-quantity>
              </div>

              <a href="/cart/change?line={{ forloop.index }}&amp;quantity=0" class="btn-link cart-item__remove medium-up--hide" data-cart-item-delete>{{ 'cart.general.remove' | t }}</a>
            </td>

            <td class="text-right small--hide">
                <span class="cart-item__price" data-cart-item-line-price>{{ item.line_price | money }}</span>
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>

    <footer class="cart-footer">
      <div class="grid grid__row">
        {% if section.settings.cart_notes_enable %}
          <div class="grid__item medium-up--one-half cart-note">
            <label for="CartSpecialInstructions" class="cart-footer__note-label small--text-center">{{ 'cart.general.note' | t }}</label>
            <textarea name="note" id="CartSpecialInstructions" class="cart-footer__note-input" rows="4" data-cart-note>{{ cart.note }}</textarea>
          </div>
        {% endif %}

        <div class="grid__item text-right small--text-center{% if section.settings.cart_notes_enable %} medium-up--one-half{% endif %}">
          <p>
            <span class="cart__subtotal-title h4">{{ 'cart.general.subtotal' | t }}</span>
            <span class="cart-footer__subtotal" data-cart-subtotal>{{ cart.total_price | money }}</span>
          </p>
          <p class="text-small">{{ 'cart.general.shipping_at_checkout' | t }}</p>
          <div class="btn-group">
            <input type="submit" name="update" class="btn btn--secondary supports-no-js supports-js--hide" value="{{ 'cart.general.update' | t }}">
            <button type="submit" name="checkout" class="btn btn--loader" data-cart-submit>
              {{ 'cart.general.checkout' | t }}
              <span class="btn--loader-balls"></span>
            </button>
          </div>
          <div class="cart-footer__message-container">
            <div class="cart-footer__message" data-cart-message></div>
          </div>
        </div>
      </div>
    </footer>
  </form>
</div>


<script>
  
  $(function() {
    getCart();
  });

</script>



{% comment %}{#<!--@formatter:off-->#}{% endcomment %}
{% schema %}
{
  "name": "Cart page",
  "settings": [
    {
      "type": "checkbox",
      "id": "cart_notes_enable",
      "label": "Enable cart notes",
      "default": true
    }
  ]
}
{% endschema %}
{% comment %}{#<!--@formatter:on-->#}{% endcomment %}
